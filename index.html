<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>¬°Feliz Navidad, Pancracia!</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 16px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a1f15 0%, #051009 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            touch-action: manipulation;
        }

        /* Fondo animado */
        #magicBackground {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* Pantalla de bienvenida - ¬°ESPECTACULAR! */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #8B0000 0%, #006400 50%, #0a1f15 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: transform 1.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            overflow: hidden;
            padding: 20px;
        }

        .welcome-screen::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23ffd700" d="M50,5 L60,40 L95,40 L65,60 L75,95 L50,75 L25,95 L35,60 L5,40 L40,40 Z"/></svg>') repeat;
            opacity: 0.1;
            animation: rotateStars 30s linear infinite;
        }

        @keyframes rotateStars {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .welcome-content {
            text-align: center;
            padding: 30px 20px;
            background: rgba(10, 31, 21, 0.85);
            border-radius: 30px;
            border: 5px solid gold;
            max-width: 800px;
            width: 95%;
            box-shadow: 
                0 0 80px rgba(255, 215, 0, 0.7),
                0 20px 50px rgba(0, 0, 0, 0.6),
                inset 0 0 40px rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 2;
            animation: welcomePulse 3s infinite alternate;
        }

        @keyframes welcomePulse {
            0% { 
                box-shadow: 0 0 80px rgba(255, 215, 0, 0.7), 0 20px 50px rgba(0, 0, 0, 0.6), inset 0 0 40px rgba(255, 255, 255, 0.1); 
                transform: scale(1);
            }
            100% { 
                box-shadow: 0 0 120px rgba(255, 215, 0, 0.9), 0 30px 70px rgba(0, 0, 0, 0.8), inset 0 0 60px rgba(255, 255, 255, 0.2); 
                transform: scale(1.02);
            }
        }

        .welcome-title {
            font-family: 'Mountains of Christmas', cursive;
            font-size: clamp(2.5rem, 8vw, 5rem);
            color: gold;
            margin-bottom: 20px;
            text-shadow: 
                3px 3px 0 #8B0000,
                6px 6px 0 rgba(0, 0, 0, 0.5);
            letter-spacing: 1px;
            animation: titleFloat 4s ease-in-out infinite alternate;
            line-height: 1.2;
        }

        @keyframes titleFloat {
            0% { transform: translateY(0) rotate(-1deg); }
            100% { transform: translateY(-10px) rotate(1deg); }
        }

        .welcome-subtitle {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            color: white;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
            animation: subtitleFloat 5s ease-in-out infinite alternate;
            line-height: 1.3;
        }

        @keyframes subtitleFloat {
            0% { transform: translateY(0); opacity: 0.9; }
            100% { transform: translateY(-8px); opacity: 1; }
        }

        .open-gift-btn {
            background: linear-gradient(45deg, #B22222, #8B0000, #B22222);
            background-size: 200% 100%;
            color: white;
            border: none;
            padding: clamp(15px, 4vw, 25px) clamp(30px, 8vw, 60px);
            font-size: clamp(1.4rem, 4vw, 2.2rem);
            border-radius: 60px;
            cursor: pointer;
            transition: all 0.4s;
            margin-top: 20px;
            box-shadow: 
                0 10px 20px rgba(0, 0, 0, 0.4),
                0 0 30px rgba(255, 215, 0, 0.5);
            font-family: 'Mountains of Christmas', cursive;
            letter-spacing: 2px;
            position: relative;
            overflow: hidden;
            animation: buttonGlow 2s infinite alternate;
            width: 90%;
            max-width: 500px;
        }

        @keyframes buttonGlow {
            0% { box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4), 0 0 30px rgba(255, 215, 0, 0.5); }
            100% { box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5), 0 0 50px rgba(255, 215, 0, 0.7); }
        }

        .open-gift-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: 0.5s;
        }

        .open-gift-btn:hover::before {
            left: 100%;
        }

        .open-gift-btn:active {
            transform: translateY(-4px) scale(1.03);
            background-position: 100% 0;
        }

        .instruction {
            margin-top: 25px;
            font-size: clamp(1rem, 3vw, 1.5rem);
            color: gold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        /* Contenido principal */
        .main-content {
            display: none;
            position: relative;
            z-index: 2;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            animation: contentAppear 1.5s;
        }

        @keyframes contentAppear {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* √Årbol interactivo */
        .tree-section {
            text-align: center;
            margin: 20px 0 40px 0;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            border: 3px solid rgba(255, 215, 0, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.5s;
        }

        .tree-section:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 215, 0, 0.6);
            transform: translateY(-5px);
        }

        .tree-container {
            display: inline-block;
            position: relative;
            cursor: pointer;
            transition: transform 0.5s;
            margin-bottom: 20px;
        }

        .tree-container:active {
            transform: scale(1.1);
        }

        .tree {
            font-size: clamp(6rem, 20vw, 12rem);
            color: #228B22;
            text-shadow: 5px 5px 15px rgba(0, 0, 0, 0.7);
            position: relative;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.3));
        }

        .tree-star {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(3rem, 10vw, 6rem);
            color: gold;
            text-shadow: 0 0 40px gold;
            animation: starTwinkle 1s infinite alternate;
            z-index: 2;
        }

        @keyframes starTwinkle {
            0% { opacity: 0.7; transform: translateX(-50%) scale(1); text-shadow: 0 0 40px gold; }
            100% { opacity: 1; transform: translateX(-50%) scale(1.2); text-shadow: 0 0 60px gold, 0 0 80px gold; }
        }

        .tree-instruction {
            font-size: clamp(1.2rem, 4vw, 1.8rem);
            color: gold;
            margin-top: 15px;
            font-family: 'Dancing Script', cursive;
        }

        /* Luces del √°rbol */
        .tree-light {
            position: absolute;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            box-shadow: 0 0 15px;
            animation: lightColorChange 3s infinite alternate;
            z-index: 1;
        }

        @keyframes lightColorChange {
            0% { background-color: #ff0000; box-shadow: 0 0 20px #ff0000; }
            25% { background-color: #00ff00; box-shadow: 0 0 20px #00ff00; }
            50% { background-color: #ffff00; box-shadow: 0 0 20px #ffff00; }
            75% { background-color: #ff00ff; box-shadow: 0 0 20px #ff00ff; }
            100% { background-color: #00ffff; box-shadow: 0 0 20px #00ffff; }
        }

        /* Regalo especial - ¬°TODO EL CONTENIDO AQU√ç! */
        .gift-section {
            text-align: center;
            margin: 20px 0 40px 0;
            padding: 30px 20px;
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.9), rgba(0, 100, 0, 0.9));
            border-radius: 20px;
            border: 4px solid gold;
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.5),
                0 0 40px rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
            min-height: 400px;
        }

        .gift-container {
            display: inline-block;
            cursor: pointer;
            transition: transform 0.5s;
            margin-bottom: 30px;
            position: relative;
        }

        .gift-container:active {
            transform: scale(1.1) rotate(5deg);
        }

        .gift {
            font-size: clamp(5rem, 15vw, 10rem);
            color: #B22222;
            text-shadow: 5px 5px 15px rgba(0, 0, 0, 0.7);
            position: relative;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.3));
        }

        .gift-bow {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(2.5rem, 6vw, 4rem);
            color: gold;
            text-shadow: 0 0 20px gold;
            z-index: 2;
        }

        .gift-instruction {
            font-size: clamp(1.2rem, 4vw, 1.8rem);
            color: gold;
            margin-top: 15px;
            font-family: 'Dancing Script', cursive;
        }

        /* Mensaje del regalo - ¬°TODO EL CONTENIDO AQU√ç! */
        .gift-message {
            display: none;
            background: rgba(255, 215, 0, 0.95);
            color: #006400; /* Color original verde oscuro */
            padding: 30px 20px;
            border-radius: 15px;
            margin-top: 30px;
            font-size: clamp(1.2rem, 3.5vw, 1.8rem);
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            line-height: 1.6;
            border: 3px solid #8B0000;
            position: relative;
            z-index: 1;
            animation: messageAppear 1s;
            text-align: left;
        }

        @keyframes messageAppear {
            0% { opacity: 0; transform: translateY(20px) scale(0.9); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        .gift-sparkles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s;
        }

        /* Estilos espec√≠ficos para el mensaje del regalo */
        .message-header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 3px solid #8B0000;
            padding-bottom: 15px;
        }

        .message-title {
            font-family: 'Mountains of Christmas', cursive;
            font-size: clamp(1.8rem, 6vw, 3.5rem);
            color: #8B0000;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0 rgba(255, 215, 0, 0.3);
        }

        .message-saludo {
            font-size: clamp(1.2rem, 4vw, 2rem);
            color: #8B0000;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .message-content {
            font-size: clamp(1rem, 3.5vw, 1.8rem);
            line-height: 1.6;
            margin-bottom: 20px;
            color: #006400; /* Color original verde oscuro */
            text-align: justify;
        }

        .message-highlight {
            color: #8B0000;
            font-size: clamp(1.4rem, 4vw, 2.5rem);
            font-weight: bold;
            text-align: center;
            margin: 25px 0;
            padding: 15px;
            background: rgba(139, 0, 0, 0.1);
            border-radius: 12px;
            border-left: 5px solid #8B0000;
            border-right: 5px solid #8B0000;
            animation: highlightPulse 2s infinite alternate;
        }

        @keyframes highlightPulse {
            0% { transform: scale(1); box-shadow: 0 5px 15px rgba(139, 0, 0, 0.2); }
            100% { transform: scale(1.02); box-shadow: 0 8px 25px rgba(139, 0, 0, 0.3); }
        }

        .message-footer {
            text-align: center;
            margin-top: 35px;
            padding-top: 20px;
            border-top: 2px solid #8B0000;
        }

        .final-message {
            font-size: clamp(1.4rem, 4vw, 2.2rem);
            color: #8B0000;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .signature {
            font-size: clamp(1.2rem, 3.5vw, 2rem);
            color: #006400; /* Color original verde oscuro */
            font-family: 'Dancing Script', cursive;
            margin-top: 25px;
            line-height: 1.5;
        }

        /* Efectos especiales del regalo */
        .gift-effects {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 0;
        }

        /* Mensaje final m√≠nimo */
        .closing-section {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            opacity: 0.8;
            transition: all 0.5s;
        }

        .closing-section:hover {
            opacity: 1;
            transform: translateY(-3px);
        }

        .closing-text {
            font-size: clamp(1.1rem, 3vw, 1.6rem);
            line-height: 1.4;
            color: rgba(255, 255, 255, 0.9);
            font-family: 'Dancing Script', cursive;
        }

        /* Mensaje flotante */
        .floating-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(10, 31, 21, 0.95);
            color: gold;
            padding: 20px 30px;
            border-radius: 20px;
            border: 3px solid gold;
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.2rem, 4vw, 2.2rem);
            z-index: 1000;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
            max-width: 90%;
            line-height: 1.4;
        }

        /* Mejoras para m√≥viles */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }

            .welcome-screen {
                padding: 10px;
            }

            .welcome-content {
                padding: 20px 15px;
                border-width: 3px;
            }

            .open-gift-btn {
                width: 95%;
                margin-top: 15px;
            }

            .main-content {
                padding: 15px 10px;
            }

            .tree-section, .gift-section {
                margin: 15px 0 30px 0;
                padding: 20px 15px;
            }

            .gift-message {
                padding: 25px 15px;
            }

            .signature {
                line-height: 1.4;
            }
        }

        @media (max-width: 480px) {
            html {
                font-size: 14px;
            }

            .welcome-title {
                font-size: 2.5rem;
                margin-bottom: 15px;
            }

            .welcome-subtitle {
                font-size: 1.6rem;
                margin-bottom: 20px;
            }

            .open-gift-btn {
                font-size: 1.4rem;
                padding: 15px 25px;
            }

            .tree {
                font-size: 6rem;
            }

            .tree-star {
                font-size: 3rem;
                top: -25px;
            }

            .gift {
                font-size: 5rem;
            }

            .gift-message {
                font-size: 1.1rem;
            }

            .message-title {
                font-size: 1.8rem;
            }

            .signature {
                font-size: 1.2rem;
            }
        }

        /* Evitar zoom en inputs en iOS */
        @media screen and (max-width: 768px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }

        /* Mejorar toques en m√≥viles */
        button, .tree-container, .gift-container {
            cursor: pointer;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <!-- Audio oculto que se reproduce autom√°ticamente -->
    <audio id="navidadMusic" autoplay loop volume="1" style="display: none;">
        <source src="Music/Burro.mp3" type="audio/mpeg">
        Tu navegador no soporta el elemento de audio.
    </audio>

    <!-- Fondo m√°gico -->
    <canvas id="magicBackground"></canvas>

    <!-- Pantalla de bienvenida ESPECTACULAR -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <h1 class="welcome-title">¬°FELIZ NAVIDAD, PANCRACIA!</h1>
            <p class="welcome-subtitle">Una sorpresa m√°gica especialmente para ti</p>
            <button class="open-gift-btn" id="openGiftBtn">
                <i class="fas fa-gift"></i> HAZ CLIC PARA TU REGALO ESPECIAL
            </button>
            <p class="instruction">¬°Descubre el mensaje navide√±o creado solo para ti!</p>
        </div>
    </div>

    <!-- Contenido principal -->
    <div class="main-content" id="mainContent">
        <!-- √Årbol interactivo -->
        <div class="tree-section">
            <h2 class="message-title">¬°Enciende el √Årbol Navide√±o!</h2>
            <div class="tree-container" id="treeContainer">
                <div class="tree-star">‚òÖ</div>
                <div class="tree">üéÑ</div>
                <div class="tree-lights" id="treeLights"></div>
            </div>
            <p class="tree-instruction">Toca el √°rbol para encender las luces m√°gicas</p>
        </div>

        <!-- Regalo especial - ¬°TODO EL CONTENIDO AQU√ç! -->
        <div class="gift-section">
            <h2 class="message-title" style="color: gold;">Tu Regalo Especial de Navidad</h2>
            <div class="gift-container" id="giftContainer">
                <div class="gift-bow">üéÄ</div>
                <div class="gift">üéÅ</div>
                <div class="gift-sparkles" id="giftSparkles"></div>
                <div class="gift-effects" id="giftEffects"></div>
            </div>
            <p class="gift-instruction">¬°Toca para abrir tu regalo y ver el mensaje especial!</p>

            <!-- Mensaje dentro del regalo - ¬°TODO EL CONTENIDO AQU√ç! -->
            <div class="gift-message" id="giftMessage">
                <div>
                    <h2 class="message-title">¬°PARA PANCRACIA, LA LOCA M√ÅS LOCA DEL UNIVERSO! ü§™üåå</h2>
                    <p class="final-message">
                        ¬°FELIZ NAVIDAD, REINA DE LA LOCURAüéÑüí•
                    </p>

                    <div style="margin-top: 30px; padding: 15px; background: rgba(255, 50, 50, 0.15); border: 3px dashed #ff6b6b; border-radius: 15px; font-family: 'Comic Sans MS', cursive;">
                        <p style="font-size: clamp(1.1rem, 3vw, 1.7rem); color: #d63384; margin-bottom: 10px;">
                            ¬°Te escribo esto entre risas, nervios y un poquito de miedo! üò±
                        </p>
                        
                        <p style="font-size: clamp(1rem, 3vw, 1.6rem); color: #e74c3c; font-style: italic; margin-bottom: 10px;">
                            Porque si tu marido lee esto‚Ä¶ ¬°de seguro se ira donde la vecina! üèÉ‚Äç
                        </p>

                        <p style="font-size: clamp(1rem, 3vw, 1.5rem); color: #2980b9; margin-bottom: 10px;">
                            Pero es que ¬°NO POD√çA NO DECIRTE FELIZ NAVIDAD!
                        </p>
                    </div>

                    <!-- SOLO CAMBIO DE COLOR AQU√ç - Texto en negro -->
                    <div class="signature" style="color: #000000; font-weight: bold;">
                        üéÖ ¬°Que esta Navidad te llene de esperanza, alegr√≠a y abrazos de los buenos!<br><br>
                        S√≠, este a√±o estuvo dif√≠cil‚Ä¶ pero lo importante es que NO TE RENDISTE.<br><br>
                        Disfruta cada momento con tu familia, hasta los m√°s locos<br>
                        porque en Navidad y todos los dias siempre ellos estar√°n ah√≠ para apoyarte.<br><br>
                        Y yo tambien siempre te estare apoyando.<br><br>
                        ¬°Sigue adelante, Pancracia! Eres fuerte, vales mucho‚Ä¶ y no est√°s sola. üí™‚ù§Ô∏è<br><br>
                        Con un abrazo de oso goloso‚Ä¶<br>
                        Te deseo una FELIZ NAVIDAD!!...<br><br>
                        ‚Äî Atte<br>Tu "patr√≥n/jefe/amo"‚Ä¶ ya sabes qui√©n üëÄ<br>
                        <b style="color: #8B0000; font-size: 1.3em;">Vlady</b>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mensaje final m√≠nimo -->
        <div class="closing-section">
            <p class="closing-text">Que el esp√≠ritu de la Navidad te acompa√±e hoy y siempre</p>
            <p class="closing-text">¬°Felices fiestas, Pancracia!</p>
        </div>
    </div>

    <script>
        // Elementos del DOM
        const welcomeScreen = document.getElementById('welcomeScreen');
        const mainContent = document.getElementById('mainContent');
        const openGiftBtn = document.getElementById('openGiftBtn');
        const treeContainer = document.getElementById('treeContainer');
        const treeLights = document.getElementById('treeLights');
        const giftContainer = document.getElementById('giftContainer');
        const giftMessage = document.getElementById('giftMessage');
        const giftSparkles = document.getElementById('giftSparkles');
        const giftEffects = document.getElementById('giftEffects');
        const magicCanvas = document.getElementById('magicBackground');
        const ctx = magicCanvas.getContext('2d');

        // Elemento de audio
        const navidadMusic = document.getElementById('navidadMusic');

        // Variables para animaciones
        let particles = [];
        let treeLit = false;
        let giftOpened = false;
        let lights = [];

        // Funci√≥n para iniciar la m√∫sica autom√°ticamente
        function startMusic() {
            // Configurar volumen al m√°ximo
            navidadMusic.volume = 1.0;
            
            // Intentar reproducir autom√°ticamente
            const playPromise = navidadMusic.play();
            
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    console.log("üéµ M√∫sica navide√±a reproduci√©ndose al 100% de volumen");
                }).catch(error => {
                    console.log("Esperando interacci√≥n del usuario para reproducir m√∫sica...");
                    // Si hay error de autoplay, intentar reproducir al primer toque
                    document.addEventListener('click', function startOnClick() {
                        navidadMusic.play();
                        console.log("üéµ M√∫sica iniciada despu√©s de la interacci√≥n del usuario");
                        document.removeEventListener('click', startOnClick);
                    }, { once: true });
                });
            }
        }

        // Ajustar tama√±o del canvas
        function resizeCanvas() {
            magicCanvas.width = window.innerWidth;
            magicCanvas.height = window.innerHeight;
        }

        // Crear part√≠culas m√°gicas para el fondo
        function createParticles() {
            particles = [];
            const particleCount = Math.min(100, Math.floor(window.innerWidth / 15));

            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: Math.random() * magicCanvas.width,
                    y: Math.random() * magicCanvas.height,
                    size: Math.random() * 3 + 1,
                    speedX: Math.random() * 0.5 - 0.25,
                    speedY: Math.random() * 0.5 - 0.25,
                    color: i % 4 === 0 ? '#ff0000' : i % 4 === 1 ? '#00ff00' : i % 4 === 2 ? '#ffff00' : '#ffd700',
                    opacity: Math.random() * 0.5 + 0.2,
                    twinkleSpeed: Math.random() * 0.03 + 0.01
                });
            }
        }

        // Dibujar part√≠culas en el fondo
        function drawParticles() {
            if (!magicCanvas || !ctx) return;
            
            ctx.clearRect(0, 0, magicCanvas.width, magicCanvas.height);

            // Fondo con gradiente
            const gradient = ctx.createRadialGradient(
                magicCanvas.width / 2, magicCanvas.height / 2, 0,
                magicCanvas.width / 2, magicCanvas.height / 2, Math.max(magicCanvas.width, magicCanvas.height)
            );
            gradient.addColorStop(0, 'rgba(139, 0, 0, 0.1)');
            gradient.addColorStop(0.5, 'rgba(0, 100, 0, 0.1)');
            gradient.addColorStop(1, 'rgba(10, 31, 21, 0.2)');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, magicCanvas.width, magicCanvas.height);

            // Dibujar part√≠culas
            particles.forEach(particle => {
                particle.opacity += particle.twinkleSpeed;
                if (particle.opacity > 0.7 || particle.opacity < 0.2) {
                    particle.twinkleSpeed = -particle.twinkleSpeed;
                }

                particle.x += particle.speedX;
                particle.y += particle.speedY;

                // Rebotar en los bordes
                if (particle.x < 0 || particle.x > magicCanvas.width) particle.speedX = -particle.speedX;
                if (particle.y < 0 || particle.y > magicCanvas.height) particle.speedY = -particle.speedY;

                // Dibujar part√≠cula
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fillStyle = particle.color.replace(')', `, ${particle.opacity})`).replace('rgb', 'rgba');
                ctx.fill();

                // Brillo alrededor
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size * 1.5, 0, Math.PI * 2);
                ctx.fillStyle = particle.color.replace(')', `, ${particle.opacity * 0.2})`).replace('rgb', 'rgba');
                ctx.fill();
            });

            requestAnimationFrame(drawParticles);
        }

        // Crear luces para el √°rbol
        function createTreeLights() {
            treeLights.innerHTML = '';
            lights = [];
            const lightCount = Math.min(18, Math.floor(window.innerWidth / 25));

            for (let i = 0; i < lightCount; i++) {
                const angle = (i / lightCount) * Math.PI * 2;
                const radius = 30 + (i % 3) * 15;

                const light = document.createElement('div');
                light.classList.add('tree-light');

                // Posicionar en forma de √°rbol
                const x = Math.cos(angle) * radius + 50;
                const y = Math.sin(angle) * radius * 0.6 + 50;

                light.style.left = `${x}%`;
                light.style.top = `${y}%`;

                // Animaci√≥n de parpadeo aleatoria
                light.style.animationDelay = `${Math.random() * 3}s`;
                light.style.opacity = '0';

                treeLights.appendChild(light);
                lights.push(light);
            }
        }

        // Encender/apagar luces del √°rbol
        function toggleTreeLights() {
            if (!treeLit) {
                // Encender luces
                lights.forEach(light => {
                    light.style.opacity = '1';
                    light.style.animationDuration = `${Math.random() * 2 + 1}s`;
                });

                // Efecto en el √°rbol
                const tree = document.querySelector('.tree');
                const star = document.querySelector('.tree-star');

                tree.style.filter = 'drop-shadow(0 0 30px #32CD32)';
                star.style.animationDuration = '0.5s';

                treeLit = true;

                // Sonido
                playMagicSound();

                // Mostrar mensaje
                setTimeout(() => {
                    showFloatingMessage("‚ú® ¬°Las luces navide√±as brillan para ti, Pancracia! ‚ú®");
                }, 500);
            } else {
                // Apagar luces
                lights.forEach(light => {
                    light.style.opacity = '0';
                });

                // Efecto en el √°rbol
                const tree = document.querySelector('.tree');
                const star = document.querySelector('.tree-star');

                tree.style.filter = 'drop-shadow(0 10px 20px rgba(0, 0, 0, 0.3))';
                star.style.animationDuration = '1s';

                treeLit = false;
            }
        }

        // Crear efectos especiales para el regalo
        function createGiftEffects() {
            giftEffects.innerHTML = '';

            // Crear efectos alrededor del regalo
            const effectCount = 6;
            const colors = ['#ff0000', '#00ff00', '#ffff00', '#ffd700', '#ffffff'];

            for (let i = 0; i < effectCount; i++) {
                const effect = document.createElement('div');
                effect.style.position = 'absolute';
                effect.style.width = '30px';
                effect.style.height = '30px';
                effect.style.background = `radial-gradient(circle, ${colors[i % colors.length]}, transparent)`;
                effect.style.borderRadius = '50%';
                effect.style.left = '50%';
                effect.style.top = '50%';
                effect.style.transform = 'translate(-50%, -50%)';
                effect.style.opacity = '0';
                effect.style.filter = 'blur(3px)';
                effect.style.zIndex = '1';

                giftEffects.appendChild(effect);

                // Animaci√≥n de expansi√≥n
                const anim = effect.animate([
                    { 
                        width: '0px', 
                        height: '0px', 
                        opacity: '0.8',
                        transform: 'translate(-50%, -50%)'
                    },
                    { 
                        width: '150px', 
                        height: '150px', 
                        opacity: '0',
                        transform: 'translate(-50%, -50%)'
                    }
                ], {
                    duration: 1200,
                    delay: i * 150,
                    easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                });

                // Eliminar despu√©s de la animaci√≥n
                anim.onfinish = () => {
                    effect.remove();
                };
            }
        }

        // Crear chispas para el regalo
        function createGiftSparkles() {
            giftSparkles.innerHTML = '';
            const sparkleCount = Math.min(40, Math.floor(window.innerWidth / 20));

            for (let i = 0; i < sparkleCount; i++) {
                const sparkle = document.createElement('div');
                sparkle.style.position = 'absolute';
                sparkle.style.width = '15px';
                sparkle.style.height = '15px';
                sparkle.style.background = 'radial-gradient(circle, #ffd700, #ffed4e)';
                sparkle.style.borderRadius = '50%';
                sparkle.style.left = `${Math.random() * 100}%`;
                sparkle.style.top = `${Math.random() * 100}%`;
                sparkle.style.boxShadow = '0 0 15px #ffd700';
                sparkle.style.animation = `sparkleFloat ${Math.random() * 2 + 1}s infinite alternate`;
                sparkle.style.zIndex = '2';

                // Crear animaci√≥n para cada sparkle
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes sparkleFloat {
                        0% { transform: translate(0, 0) scale(1); opacity: 0.8; }
                        100% { transform: translate(${Math.random() * 60 - 30}px, ${Math.random() * 60 - 30}px) scale(${Math.random() * 0.5 + 0.5}); opacity: 0.2; }
                    }
                `;
                document.head.appendChild(style);

                giftSparkles.appendChild(sparkle);
            }
        }

        // Abrir el regalo - ¬°EFECTOS MEJORADOS!
        function openGift() {
            if (!giftOpened) {
                // Mostrar mensaje del regalo
                giftMessage.style.display = 'block';
                giftSparkles.style.opacity = '1';

                // Animaci√≥n del regalo
                giftContainer.style.transform = 'scale(1.2) rotate(10deg)';

                // Crear efectos especiales
                createGiftEffects();
                createGiftSparkles();

                // Sonido m√°gico
                playMagicSound();

                // Crear confeti
                createConfetti();

                giftOpened = true;

                // Mostrar mensaje flotante
                setTimeout(() => {
                    showFloatingMessage("üéÅ ¬°TU REGALO ESPECIAL EST√Å ABIERTO! üéÅ\n\nLee el mensaje completo dentro del regalo");
                }, 600);

                // Restaurar tama√±o del regalo despu√©s de la animaci√≥n
                setTimeout(() => {
                    giftContainer.style.transform = 'scale(1.1) rotate(5deg)';
                }, 400);

                // Desplazarse suavemente al mensaje
                setTimeout(() => {
                    giftMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 800);
            }
        }

        // Crear efecto de confeti
        function createConfetti() {
            const confettiCount = Math.min(70, Math.floor(window.innerWidth / 10));
            const colors = ['#ff0000', '#00ff00', '#ffff00', '#ffd700', '#ffffff', '#ffa500'];

            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = '12px';
                confetti.style.height = '12px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.top = '-20px';
                confetti.style.zIndex = '1000';
                confetti.style.opacity = '0.9';
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                confetti.style.boxShadow = '0 0 8px currentColor';

                document.body.appendChild(confetti);

                // Animaci√≥n
                const animation = confetti.animate([
                    { transform: `translate(0, 0) rotate(0deg)`, opacity: 1 },
                    { transform: `translate(${Math.random() * 200 - 100}px, 100vh) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                ], {
                    duration: Math.random() * 3000 + 1500,
                    easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
                });

                // Eliminar despu√©s de la animaci√≥n
                animation.onfinish = () => {
                    if (confetti.parentNode) {
                        confetti.remove();
                    }
                };
            }
        }

        // Sonido m√°gico
        function playMagicSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();

                // Crear sonido m√°gico con m√∫ltiples osciladores
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();

                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);

                        const note = [523.25, 659.25, 783.99][i]; // Do, Mi, Sol
                        oscillator.frequency.setValueAtTime(note, audioContext.currentTime);
                        oscillator.type = ['sine', 'triangle', 'sawtooth'][i];

                        gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                        gainNode.gain.linearRampToValueAtTime(0.03, audioContext.currentTime + 0.1);
                        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 1.0);

                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 1.0);
                    }, i * 80);
                }
            } catch (error) {
                console.log("Audio no disponible");
            }
        }

        // Mostrar mensaje flotante
        function showFloatingMessage(text) {
            const message = document.createElement('div');
            message.className = 'floating-message';
            message.textContent = text;
            message.style.whiteSpace = 'pre-line';

            document.body.appendChild(message);

            // Animar entrada
            setTimeout(() => {
                message.style.opacity = '1';
                message.style.transform = 'translate(-50%, -60%)';
            }, 50);

            // Animar salida y eliminar
            setTimeout(() => {
                message.style.opacity = '0';
                message.style.transform = 'translate(-50%, -70%)';

                setTimeout(() => {
                    if (message.parentNode) {
                        document.body.removeChild(message);
                    }
                }, 500);
            }, 2500);
        }

        // Abrir la p√°gina (bot√≥n de bienvenida)
        openGiftBtn.addEventListener('click', function() {
            // Efecto de chispas al abrir
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight;
                    createSparkle(x, y);
                }, i * 40);
            }

            // Sonido m√°gico
            playMagicSound();

            // Animaci√≥n de salida de la pantalla de bienvenida
            welcomeScreen.style.transform = 'translateY(-100%) rotateX(90deg)';

            // Mostrar contenido principal despu√©s de un tiempo
            setTimeout(() => {
                welcomeScreen.style.display = 'none';
                mainContent.style.display = 'block';

                // Inicializar efectos
                createTreeLights();
                createGiftSparkles();

                // Mostrar mensaje de bienvenida
                setTimeout(() => {
                    showFloatingMessage("¬°Bienvenida, Pancracia! üéÑ\n\nToca el √°rbol y luego abre tu regalo especial");
                }, 600);

            }, 1200);
        });

        // Crear chispas individuales
        function createSparkle(x, y) {
            const sparkle = document.createElement('div');
            sparkle.style.position = 'fixed';
            sparkle.style.width = '8px';
            sparkle.style.height = '8px';
            sparkle.style.background = 'radial-gradient(circle, #ffd700, #ffed4e)';
            sparkle.style.borderRadius = '50%';
            sparkle.style.left = `${x}px`;
            sparkle.style.top = `${y}px`;
            sparkle.style.zIndex = '1000';
            sparkle.style.boxShadow = '0 0 12px #ffd700';
            sparkle.style.pointerEvents = 'none';

            document.body.appendChild(sparkle);

            // Animaci√≥n
            sparkle.animate([
                { opacity: 0, transform: 'scale(0) translate(0, 0)' },
                { opacity: 1, transform: 'scale(1) translate(0, 0)' },
                { opacity: 0, transform: 'scale(0) translate(20px, -20px)' }
            ], {
                duration: 1000,
                easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
            });

            // Eliminar despu√©s de la animaci√≥n
            setTimeout(() => {
                if (sparkle.parentNode) {
                    document.body.removeChild(sparkle);
                }
            }, 1000);
        }

        // Interacci√≥n con el √°rbol (touch support)
        treeContainer.addEventListener('click', toggleTreeLights);
        treeContainer.addEventListener('touchstart', function(e) {
            e.preventDefault();
            toggleTreeLights();
        });

        // Interacci√≥n con el regalo (touch support)
        giftContainer.addEventListener('click', openGift);
        giftContainer.addEventListener('touchstart', function(e) {
            e.preventDefault();
            openGift();
        });

        // Inicializar
        window.addEventListener('load', function() {
            // Iniciar m√∫sica autom√°ticamente
            startMusic();
            
            resizeCanvas();
            createParticles();
            drawParticles();

            // Ajustar canvas al cambiar tama√±o de ventana
            window.addEventListener('resize', function() {
                resizeCanvas();
                createParticles();
            });

            // Mensaje en consola
            console.log("%cüéÑ ¬°FELIZ NAVIDAD, PANCRACIA! üéÑ", "color: gold; font-size: 20px; font-weight: bold; text-shadow: 2px 2px 0 #8B0000");
            console.log("%cEste mensaje fue creado especialmente para recordarte lo incre√≠ble que eres. ¬°Nunca te rindas! ‚ù§Ô∏è", "color: #32CD32; font-size: 14px;");

            // Auto-iniciar despu√©s de 5 segundos (opcional)
            setTimeout(() => {
                if (welcomeScreen.style.display !== 'none') {
                    // Parpadear el bot√≥n para llamar la atenci√≥n
                    openGiftBtn.style.animation = 'buttonGlow 0.5s infinite alternate';
                    setTimeout(() => {
                        openGiftBtn.style.animation = 'buttonGlow 2s infinite alternate';
                    }, 1500);
                }
            }, 3000);
        });

        // Permitir reiniciar la p√°gina con la tecla R
        document.addEventListener('keydown', function(e) {
            if (e.key === 'r' || e.key === 'R') {
                location.reload();
            }
        });

        // Mejorar experiencia t√°ctil
        document.addEventListener('touchstart', function() {}, {passive: true});
        document.addEventListener('touchmove', function(e) {
            if (e.scale !== 1) {
                e.preventDefault();
            }
        }, {passive: false});
    </script>
</body>
</html>
